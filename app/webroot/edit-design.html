<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />	<title>
		SumoDinner: Dine like a Sumo:
		Recipes	</title>
	<link href="/SumoDinner/favicon.ico" type="image/x-icon" rel="icon" /><link href="/SumoDinner/favicon.ico" type="image/x-icon" rel="shortcut icon" /><link rel="stylesheet" type="text/css" href="/SumoDinner/css/cake.generic.css" /><link rel="stylesheet" type="text/css" href="/SumoDinner/css/jquery-ui-1.9.2.custom.css" /></head>
<body>
	<div id="container">
		<div id="header">
			<h1></h1>
		</div>
		<div id="content">

			
			<!-- File: /app/View/Recipes/edit.ctp -->
<script type="text/javascript" src="/SumoDinner/js/jquery.js"></script><script type="text/javascript" src="/SumoDinner/js/jquery-ui-1.9.2.custom.js"></script><script type="text/javascript" src="/SumoDinner/js/plupload.full.js"></script><script type="text/javascript" src="/SumoDinner/js/advanced.js"></script><script type="text/javascript" src="/SumoDinner/js/wysihtml5-0.3.0.min.js"></script><link rel="stylesheet" type="text/css" href="/SumoDinner/css/wysihtml5.css" />/Applications/MAMP/htdocs/SumoDinner/app/webroot/css/wysihtml5.css<h1>Edit Recipe</h1>

<style>
#images_editor { list-style-type: none; margin: 0; padding: 0; width: 550px; }
#images_editor li { margin: 3px 3px 3px 3px; padding: 1px; float: left; width: 100px; height: 90px; font-size: 4em; text-align: center; position: relative;}
 html>body #images_editor li { height: 1.5em; line-height: 1.2em; }
.ui-state-highlight { height: 1.5em; line-height: 1.2em; }

.classname {
        z-index: 6;
	-moz-box-shadow:inset 0px 1px 0px 0px #f29c93;
	-webkit-box-shadow:inset 0px 1px 0px 0px #f29c93;
	box-shadow:inset 0px 1px 0px 0px #f29c93;
	background:-webkit-gradient( linear, left top, left bottom, color-stop(0.05, #fe1a00), color-stop(1, #ce0100) );
	background:-moz-linear-gradient( center top, #fe1a00 5%, #ce0100 100% );
	filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#fe1a00', endColorstr='#ce0100');
	background-color:#fe1a00;
	-moz-border-radius:6px;
	-webkit-border-radius:6px;
	border-radius:6px;
	border:1px solid #d83526;
	display:inline-block;
	font-family:arial;
	font-size:11px;
        line-height: 12px;
	font-weight:bold;
	padding:4px 5px;
	text-decoration:none;
	text-shadow:1px 1px 0px #b23e35;
        color:white;
        position: absolute;
        top:-4px;
        left:45px;
        width: 60px;
        height: 20px;
}.classname:hover {
        color:#ffffff;
	background:-webkit-gradient( linear, left top, left bottom, color-stop(0.05, #ce0100), color-stop(1, #fe1a00) );
	background:-moz-linear-gradient( center top, #ce0100 5%, #fe1a00 100% );
	filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#ce0100', endColorstr='#fe1a00');
	background-color:#ce0100;
}.classname:active {
        color:#ffffff;
	position:relative;
	top:1px;
}
.classname a {
    color:#ffffff;
}
/* This imageless css button was generated by CSSButtonGenerator.com */
</style>
<script>
$(function() {
    
    /**
 * Function : dump()
 * Arguments: The data - array,hash(associative array),object
 *    The level - OPTIONAL
 * Returns  : The textual representation of the array.
 * This function was inspired by the print_r function of PHP.
 * This will accept some data as the argument and return a
 * text that will be a more readable version of the
 * array/hash/object that is given.
 * Docs: http://www.openjs.com/scripts/others/dump_function_php_print_r.php
 */
function dump(arr,level) {
	var dumped_text = "";
	if(!level) level = 0;
	
	//The padding given at the beginning of the line.
	var level_padding = "";
	for(var j=0;j<level+1;j++) level_padding += "    ";
	
	if(typeof(arr) == 'object') { //Array/Hashes/Objects 
		for(var item in arr) {
			var value = arr[item];
			
			if(typeof(value) == 'object') { //If it is an array,
				dumped_text += level_padding + "'" + item + "' ...\n";
				dumped_text += dump(value,level+1);
			} else {
				dumped_text += level_padding + "'" + item + "' => \"" + value + "\"\n";
			}
		}
	} else { //Stings/Chars/Numbers etc.
		dumped_text = "===>"+arr+"<===("+typeof(arr)+")";
	}
	return dumped_text;
}
    
/** Handle sortable elements **/

// run the currently selected effect
function runHideEffect(object,effect) {
        
        var selectedEffect = effect;
        // most effect types need no options passed by default
        var options = {};
        // some effects have required parameters
        if ( selectedEffect === "scale" ) {
                options = { percent: 0 };
        } else if ( selectedEffect === "size" ) {
                options = { to: { width: 200, height: 60 } };
        }
        // run the effect
        $( object).hide( selectedEffect, options, 500, removeDOMObject);
};

//Make images sortable with jquery sortable class
$( "#images_editor" ).sortable({
    placeholder: "ui-state-highlight"
});

//Prefent selection on sortable elements
$( "#images_editor" ).disableSelection();

/** Handle the sortupdate event which occurs when the user changes
*   the image position. This function sets the necassary fileds to
*   update the corresponding app information when the form is saved. 
**/
$("#images_editor").bind( "sortupdate", function(event, ui) {
    $('ul#images_editor > li').each(function(index) {
            //get the image node
            var attr_helper = $('img',this).attr('name');
            var selector_helper = $('img',this).attr('src');
            
            selector_helper_split = selector_helper.split("/");
            selector_helper = selector_helper_split[(selector_helper_split.length -1)];
            
            attr_split = attr_helper.split("_");
            
            //Leave function if image is markt for delete
            if (attr_split[1] == -1) {
                return;
            }
            
            attr_helper = (attr_split[0]+'_'+ index);
            $('img',this).attr('name', attr_helper);

            var input_img_name = $('input[value|="'+selector_helper+'"]').attr('name');

            input_img_number_array = input_img_name.split("[");
            input_img_number = input_img_number_array[2].substr(0,input_img_number_array[2].length-1);

            $('input[name|="data[Image]['+input_img_number+'][ordernum]"]').removeAttr('value');
            $('input[name|="data[Image]['+input_img_number+'][ordernum]"]').attr('value',index);
    });
});
     function removeDOMObject(object) {
        //alert('Hallo');
        //alert(imgListObject);
        this.remove();
    }
        
    $(".classname").click(function() {
        var imgListObject = $(this).parent();
        var imgID = this.id;
        var lastOrderNum = $(imgListObject).children('img').attr('name').split("_")[1];
        
        //Set img name attribute to -1 and mark it for deletion
        $(imgListObject).children('img').attr('name',"pic_-1");
        
        //Leave function if ordernum is negative
        if (lastOrderNum < 0 ) {
            return;
        }
        
        $('ul#images_editor > li').each(function(index) {
            
            var imgOrderNum = $(this).children('img').attr('name').split("_")[1];
            var selector_helper = $(this).children('img').attr('src').split("/")[$(this).children('img').attr('src').split("/").length -1];
            var input_img_name = $('input[value|="'+selector_helper+'"]').attr('name');

            input_img_number_array = input_img_name.split("[");
            input_img_number = input_img_number_array[2].substr(0,input_img_number_array[2].length-1);
            
            //alert(selector_helper);
                
            if (imgOrderNum > lastOrderNum) {
                $(this).children('img').attr('name', "pic_"+(imgOrderNum -1));                
                $('input[name|="data[Image]['+input_img_number+'][ordernum]"]').removeAttr('value');
                $('input[name|="data[Image]['+input_img_number+'][ordernum]"]').attr('value',(imgOrderNum -1));
                
                //alert ("Changed Ordernum "+imgOrderNum+" to new Ordernum "+(imgOrderNum -1))
            }
            if (imgOrderNum == -1) {
                $('input[name|="data[Image]['+input_img_number+'][ordernum]"]').removeAttr('value');
                $('input[name|="data[Image]['+input_img_number+'][ordernum]"]').attr('value',-1);
            }
        });
        
        runHideEffect(imgListObject,'highlight');
        
        //imgListObject.css("width", "200px");
        //runHideEffect(imgListObject,'highlight');
        
        //$(imgListObject+' > img').css("width", "10px");
       
        //alert ($(imgListObject).children('img').attr('name'));
        /** Possible ajax delete
        var imgDel = $.post("/SumoDinner/recipes/removeImage.json", { pic_id : imgID});
        imgDel.success(function(data) {
               // alert('Hallo');
                //alert(data.rq);
                //var obj = jQuery.parseJSON(data);
                //alert(data.pic_id);
                //test();
                runHideEffect(imgListObject,'highlight');
                //$("#error").show();
                //$("#error").append(data.pic_id);
                
            });
        imgDel.error(function() {
             $("#error").show();
             $("#error").append("<b>Image could not be deleted</b>");
        }); 
       **/
    });
/** END Handle sortable elements **/

    var editor = new wysihtml5.Editor("wysihtml5-textarea", { // id of textarea element
        toolbar:      "wysihtml5-toolbar", // id of toolbar element
        parserRules:  wysihtml5ParserRules, // defined in parser rules set 
        stylesheets: ['/SumoDinner/css/wysihtml5.css']
    }); 
});
</script>
<div id="error" style="display:none"></div>
<div id="wysihtml5-toolbar" style="display: none;">
  <a data-wysihtml5-command="bold">bold</a>
  <a data-wysihtml5-command="italic">italic</a>
  
  <!-- Some wysihtml5 commands require extra parameters -->
  <a data-wysihtml5-command="foreColor" data-wysihtml5-command-value="red">red</a>
  <a data-wysihtml5-command="foreColor" data-wysihtml5-command-value="green">green</a>
  <a data-wysihtml5-command="foreColor" data-wysihtml5-command-value="blue">blue</a>
   <a data-wysihtml5-command="insertUnorderedList">insertUnorderedList</a>
    <a data-wysihtml5-command="insertOrderedList">insertOrderedList</a>
    <a data-wysihtml5-action="change_view">switch to html view</a>
  
  <!-- Some wysihtml5 commands like 'createLink' require extra paramaters specified by the user (eg. href) -->
  <a data-wysihtml5-command="createLink">insert link</a>
  <div data-wysihtml5-dialog="createLink" style="display: none;">
    <label>
      Link:
      <input data-wysihtml5-dialog-field="href" value="http://" class="text">
    </label>
    <a data-wysihtml5-dialog-action="save">OK</a> <a data-wysihtml5-dialog-action="cancel">Cancel</a>
  </div>
</div>

<form><textarea id="wysihtml5-textarea" placeholder="Enter your text ..." autofocus></textarea></form>
<form action="/SumoDinner/recipes/edit/126" id="RecipeEditForm" method="post" accept-charset="utf-8"><div style="display:none;"><input type="hidden" name="_method" value="POST"/></div><div class="input text required"><label for="RecipeTitle">Title</label><input name="data[Recipe][title]" type="text" value="1" id="RecipeTitle"/></div><div class="input textarea required"><label for="RecipeDescription">Description</label><textarea name="data[Recipe][description]" rows="3" cols="30" id="RecipeDescription">2</textarea></div><div class="input textarea required"><label for="RecipeIngredients">Ingredients</label><textarea name="data[Recipe][ingredients]" rows="2" cols="30" id="RecipeIngredients">3</textarea></div><div class="input number required"><label for="RecipeSeverity">Severity</label><input name="data[Recipe][severity]" type="number" value="4" id="RecipeSeverity"/></div><div class="input text required"><label for="CategoryName">Categories</label><input name="data[Category][name]" value="5" type="text" id="CategoryName"/></div><input type="hidden" name="data[Recipe][id]" value="126" id="RecipeId"/><input type="hidden" name="data[Recipe][contentkey]" value="50f6cb5e-8994-4c6e-8537-0d8c3b9153d1" id="RecipeContentkey"/><input type="hidden" name="data[Image][0][id]" value="109" id="Image0Id"/><input type="hidden" name="data[Image][0][name]" value="p17h20kerr87u12q5qi31gpb1nel3.png" id="Image0Name"/><input type="hidden" name="data[Image][0][ordernum]" value="0" id="Image0Ordernum"/><input type="hidden" name="data[Image][1][id]" value="110" id="Image1Id"/><input type="hidden" name="data[Image][1][name]" value="p17h20kerrmth16ele4t13vunp14.jpg" id="Image1Name"/><input type="hidden" name="data[Image][1][ordernum]" value="1" id="Image1Ordernum"/><input type="hidden" name="data[Image][2][id]" value="111" id="Image2Id"/><input type="hidden" name="data[Image][2][name]" value="p17h20kerrf4njc931e1os51nbn5.jpg" id="Image2Name"/><input type="hidden" name="data[Image][2][ordernum]" value="2" id="Image2Ordernum"/><input type="hidden" name="data[Image][3][id]" value="112" id="Image3Id"/><input type="hidden" name="data[Image][3][name]" value="p17h20kerrp7r15habe317jl1ulp6.jpg" id="Image3Name"/><input type="hidden" name="data[Image][3][ordernum]" value="3" id="Image3Ordernum"/><input type="hidden" name="data[Image][4][id]" value="113" id="Image4Id"/><input type="hidden" name="data[Image][4][name]" value="p17h20kerr7qk1lifgf21j0gak57.jpg" id="Image4Name"/><input type="hidden" name="data[Image][4][ordernum]" value="4" id="Image4Ordernum"/><input type="hidden" name="data[Image][5][id]" value="114" id="Image5Id"/><input type="hidden" name="data[Image][5][name]" value="p17h20kerrine15oghuh134m1bbi8.jpg" id="Image5Name"/><input type="hidden" name="data[Image][5][ordernum]" value="5" id="Image5Ordernum"/><input type="hidden" name="data[Image][6][id]" value="115" id="Image6Id"/><input type="hidden" name="data[Image][6][name]" value="p17h20kerrna61kg54hs16lgla79.jpg" id="Image6Name"/><input type="hidden" name="data[Image][6][ordernum]" value="6" id="Image6Ordernum"/><input type="hidden" name="data[Image][7][id]" value="116" id="Image7Id"/><input type="hidden" name="data[Image][7][name]" value="p17h20kerr1bov1j7n1o0fhn5mdga.jpg" id="Image7Name"/><input type="hidden" name="data[Image][7][ordernum]" value="7" id="Image7Ordernum"/><input type="hidden" name="data[Image][8][id]" value="117" id="Image8Id"/><input type="hidden" name="data[Image][8][name]" value="p17h20kersqih1iatdaf177o10d4b.jpg" id="Image8Name"/><input type="hidden" name="data[Image][8][ordernum]" value="8" id="Image8Ordernum"/><input type="hidden" name="data[Image][9][id]" value="118" id="Image9Id"/><input type="hidden" name="data[Image][9][name]" value="p17h20kersuuo1mh23eedgr1hk6c.jpg" id="Image9Name"/><input type="hidden" name="data[Image][9][ordernum]" value="9" id="Image9Ordernum"/><input type="hidden" name="data[Image][10][id]" value="119" id="Image10Id"/><input type="hidden" name="data[Image][10][name]" value="p17h20kers1h3folf1ots1qr19hed.jpg" id="Image10Name"/><input type="hidden" name="data[Image][10][ordernum]" value="10" id="Image10Ordernum"/><div class="submit"><input  type="submit" value="Save Recipe"/></div></form><ul id="images_editor">
    <li class='ui-state-default'><img src="/SumoDinner/uploads/50f6cb5e-8994-4c6e-8537-0d8c3b9153d1/p17h20kerr87u12q5qi31gpb1nel3.png" alt="CakePHP" width="100px" height="90px" name="pic_0" /><button class='classname' id='109'>Löschen</button></li><li class='ui-state-default'><img src="/SumoDinner/uploads/50f6cb5e-8994-4c6e-8537-0d8c3b9153d1/p17h20kerrmth16ele4t13vunp14.jpg" alt="CakePHP" width="100px" height="90px" name="pic_1" /><button class='classname' id='110'>Löschen</button></li><li class='ui-state-default'><img src="/SumoDinner/uploads/50f6cb5e-8994-4c6e-8537-0d8c3b9153d1/p17h20kerrf4njc931e1os51nbn5.jpg" alt="CakePHP" width="100px" height="90px" name="pic_2" /><button class='classname' id='111'>Löschen</button></li><li class='ui-state-default'><img src="/SumoDinner/uploads/50f6cb5e-8994-4c6e-8537-0d8c3b9153d1/p17h20kerrp7r15habe317jl1ulp6.jpg" alt="CakePHP" width="100px" height="90px" name="pic_3" /><button class='classname' id='112'>Löschen</button></li><li class='ui-state-default'><img src="/SumoDinner/uploads/50f6cb5e-8994-4c6e-8537-0d8c3b9153d1/p17h20kerr7qk1lifgf21j0gak57.jpg" alt="CakePHP" width="100px" height="90px" name="pic_4" /><button class='classname' id='113'>Löschen</button></li><li class='ui-state-default'><img src="/SumoDinner/uploads/50f6cb5e-8994-4c6e-8537-0d8c3b9153d1/p17h20kerrine15oghuh134m1bbi8.jpg" alt="CakePHP" width="100px" height="90px" name="pic_5" /><button class='classname' id='114'>Löschen</button></li><li class='ui-state-default'><img src="/SumoDinner/uploads/50f6cb5e-8994-4c6e-8537-0d8c3b9153d1/p17h20kerrna61kg54hs16lgla79.jpg" alt="CakePHP" width="100px" height="90px" name="pic_6" /><button class='classname' id='115'>Löschen</button></li><li class='ui-state-default'><img src="/SumoDinner/uploads/50f6cb5e-8994-4c6e-8537-0d8c3b9153d1/p17h20kerr1bov1j7n1o0fhn5mdga.jpg" alt="CakePHP" width="100px" height="90px" name="pic_7" /><button class='classname' id='116'>Löschen</button></li><li class='ui-state-default'><img src="/SumoDinner/uploads/50f6cb5e-8994-4c6e-8537-0d8c3b9153d1/p17h20kersqih1iatdaf177o10d4b.jpg" alt="CakePHP" width="100px" height="90px" name="pic_8" /><button class='classname' id='117'>Löschen</button></li><li class='ui-state-default'><img src="/SumoDinner/uploads/50f6cb5e-8994-4c6e-8537-0d8c3b9153d1/p17h20kersuuo1mh23eedgr1hk6c.jpg" alt="CakePHP" width="100px" height="90px" name="pic_9" /><button class='classname' id='118'>Löschen</button></li><li class='ui-state-default'><img src="/SumoDinner/uploads/50f6cb5e-8994-4c6e-8537-0d8c3b9153d1/p17h20kers1h3folf1ots1qr19hed.jpg" alt="CakePHP" width="100px" height="90px" name="pic_10" /><button class='classname' id='119'>Löschen</button></li></ul>

		</div>
		<div id="footer">
					</div>
	</div>
	<table class="cake-sql-log" id="cakeSqlLog_135860467250faa980398692_27230592" summary="Cake SQL Log" cellspacing="0"><caption>(default) 4 queries took 1 ms</caption>	<thead>
		<tr><th>Nr</th><th>Query</th><th>Error</th><th>Affected</th><th>Num. rows</th><th>Took (ms)</th></tr>
	</thead>
	<tbody>
	<tr><td>1</td><td>SELECT &quot;Recipe&quot;.&quot;id&quot;, &quot;Recipe&quot;.&quot;title&quot;, &quot;Recipe&quot;.&quot;description&quot;, &quot;Recipe&quot;.&quot;severity&quot;, &quot;Recipe&quot;.&quot;rating&quot;, &quot;Recipe&quot;.&quot;created&quot;, &quot;Recipe&quot;.&quot;modified&quot;, &quot;Recipe&quot;.&quot;ingredients&quot;, &quot;Recipe&quot;.&quot;contentkey&quot; FROM &quot;main&quot;.&quot;recipes&quot; AS &quot;Recipe&quot;   WHERE &quot;Recipe&quot;.&quot;id&quot; = 126    LIMIT 1</td><td></td><td style = "text-align: right">0</td><td style = "text-align: right">0</td><td style = "text-align: right">1</td></tr>
<tr><td>2</td><td>SELECT &quot;CategoryRecipe&quot;.&quot;id&quot;, &quot;CategoryRecipe&quot;.&quot;category_id&quot;, &quot;CategoryRecipe&quot;.&quot;recipe_id&quot; FROM &quot;main&quot;.&quot;categories_recipes&quot; AS &quot;CategoryRecipe&quot;   WHERE &quot;CategoryRecipe&quot;.&quot;recipe_id&quot; = (126)   </td><td></td><td style = "text-align: right">0</td><td style = "text-align: right">0</td><td style = "text-align: right">0</td></tr>
<tr><td>3</td><td>SELECT &quot;Image&quot;.&quot;id&quot;, &quot;Image&quot;.&quot;name&quot;, &quot;Image&quot;.&quot;titel&quot;, &quot;Image&quot;.&quot;ordernum&quot;, &quot;Image&quot;.&quot;recipe_id&quot; FROM &quot;main&quot;.&quot;images&quot; AS &quot;Image&quot;   WHERE &quot;Image&quot;.&quot;recipe_id&quot; = (126)   ORDER BY &quot;Image&quot;.&quot;ordernum&quot; ASC </td><td></td><td style = "text-align: right">0</td><td style = "text-align: right">0</td><td style = "text-align: right">0</td></tr>
<tr><td>4</td><td>SELECT &quot;Category&quot;.&quot;id&quot;, &quot;Category&quot;.&quot;name&quot;, &quot;Category&quot;.&quot;orderNum&quot;, &quot;Category&quot;.&quot;created&quot;, &quot;Category&quot;.&quot;modified&quot;, &quot;CategoryRecipe&quot;.&quot;id&quot;, &quot;CategoryRecipe&quot;.&quot;category_id&quot;, &quot;CategoryRecipe&quot;.&quot;recipe_id&quot; FROM &quot;main&quot;.&quot;categories&quot; AS &quot;Category&quot; JOIN &quot;main&quot;.&quot;categories_recipes&quot; AS &quot;CategoryRecipe&quot; ON (&quot;CategoryRecipe&quot;.&quot;recipe_id&quot; = 126 AND &quot;CategoryRecipe&quot;.&quot;category_id&quot; = &quot;Category&quot;.&quot;id&quot;)    </td><td></td><td style = "text-align: right">0</td><td style = "text-align: right">0</td><td style = "text-align: right">0</td></tr>
	</tbody></table>
	</body>
</html>
